# æå¤±å‡½æ•¸å°±æ˜¯æ¨¡å‹é æ¸¬çš„å€¼èˆ‡çœŸå¯¦å€¼ä¹‹é–“çš„å·®è·ï¼Œå…¶æ¢¯åº¦å°±æ˜¯æ¯å€‹åƒæ•¸æ±‚çš„åå°æ•¸ã€‚
import tensorflow as tf
a = tf.constant(1.)
b = tf.constant(2.)
c = tf.constant(3.)
w = tf.constant(4.)

# æ„å»ºæ¢¯åº¦ç¯å¢ƒ
with tf.GradientTape() as tape:
  tape.watch([w, a])  # å°†wåŠ å…¥æ¢¯åº¦è·Ÿè¸ªåˆ—è¡¨
  y = a * w**2 + b * w + c  # åå°æ•¸ç‚º2ğ‘+ğ‘

[dy_dw, dy_da] = tape.gradient(y, [w, a])
print(dy_dw, dy_da)  # æ‰“å°å‡ºwå°yçš„åå¯¼æ•°ã€aå°yçš„åå¯¼æ•°ï¼ˆåå¾®åˆ†ï¼‰

# åå¾®åˆ†æ˜¯åœ¨ä¸€å€‹æ›²é¢ä¸­ï¼Œæ‰¾ä¸€æ¢åˆ‡ç·šä¸¦æ±‚å‡ºå®ƒçš„æ–œç‡ã€‚
# æ–œç‡ä½œç‚º
